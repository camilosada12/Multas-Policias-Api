version: "3.9"

services:
  # SQL Server - DEV
  sqlserverBack-dev:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: sqlserverBack-dev
    restart: always
    env_file:
      - ../environments/dev/.env      # apunta al archivo .env donde est√° SQLSERVER_PASSWORD y SQLSERVER_DB
    environment:
      ACCEPT_EULA: "Y"
      SA_PASSWORD: ${SQLSERVER_PASSWORD}
      MSSQL_PID: "Developer"
    ports:
      - "1434:1433"
    volumes:
      - sqlserver_data_dev:/var/opt/mssql
    networks:
      - multas_network

  # SQL Server - QA
  sqlserverBack-qa:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: sqlserverBack-qa
    restart: always
    env_file:
      - ../environments/qa/.env
    environment:
      ACCEPT_EULA: "Y"
      SA_PASSWORD: ${SQLSERVER_PASSWORD}
      MSSQL_PID: "Developer"
    ports:
      - "1435:1433"
    volumes:
      - sqlserver_data_qa:/var/opt/mssql
    networks:
      - multas_network

  # SQL Server - STAGING
  sqlserverBack-staging:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: sqlserverBack-staging
    restart: always
    env_file:
      - ../environments/staging/.env
    environment:
      ACCEPT_EULA: "Y"
      SA_PASSWORD: ${SQLSERVER_PASSWORD}
      MSSQL_PID: "Developer"
    ports:
      - "1436:1433"
    volumes:
      - sqlserver_data_staging:/var/opt/mssql
    networks:
      - multas_network

  # SQL Server - PROD
  sqlserverBack-prod:
    image: mcr.microsoft.com/mssql/server:2022-latest
    container_name: sqlserverBack-prod
    restart: always
    env_file:
      - ../environments/prod/.env
    environment:
      ACCEPT_EULA: "Y"
      SA_PASSWORD: ${SQLSERVER_PASSWORD}
      MSSQL_PID: "Developer"
    ports:
      - "1437:1433"
    volumes:
      - sqlserver_data_prod:/var/opt/mssql
    networks:
      - multas_network

volumes:
  sqlserver_data_dev:
  sqlserver_data_qa:
  sqlserver_data_staging:
  sqlserver_data_prod:

networks:
  multas_network:
    name: multas_network
    driver: bridge
    external: false
